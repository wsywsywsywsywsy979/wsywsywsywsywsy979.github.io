<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>UAS:构音障碍短句子归一化</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.1/css/bootstrap.min.css"
        integrity="sha384-VCmXjywReHh4PwowAiWNagnWcLhlEJLA5buUprzK8rxFgeH0kww/aWY76TfkUoSX" crossorigin="anonymous">
    <link rel="stylesheet" href="./style.css">
    <script src="resources/jquery.min.js"></script>
    <script src="resources/script.js"></script>
    <center> 
        <h6 style="font-family: 新宋体;">
            请在安静环境下佩戴耳机用谷歌浏览器完成以下问题，问卷由程序随机生成，欢迎您在提交成功后通过刷新页面多次作答。
            <!-- 文本放置有输入测试，您可以选择发音[大于n个单词的英文句子]的音频测试模型转换效果。 -->
            <!-- 这个无法测试。 不要删，给后续做实际演示一个参考-->

            <br>
            评估分为两部分：语音自然度评估和语音相似度评估。
            <br>
            语音自然度评估方式：请依次播放“转换结果”栏的音频，如果该音频与机器音越接近则得分越低，与人声越接近则得分越高。
            <br>
            语音相似度评估方式：请将每一行的“参考wav”与对应行的“转换结果”进行对比，如果“转换结果”与“参考wav”越像则得分越高，反之得分越低。
            <br>
            评分标准如下表所示：
            <p style="text-align: center">
                <img src="resources/static/mos.png" style="margin:0 auto; width: 55%;">
            </p>
        </h6>
    </center>
</head>

<body>
    <form id="theForm" action="https://script.google.com/macros/s/AKfycbxwc4EP7Rw0SSvCKjYe_InMY-P4BLkqjh5VDz7uJJ-anKohPzgAL5X1bpWiR7rRRsSl/dev" method="GET" onsubmit="return preventRepeatedSubmission();">
        <center>
            <div class="form-group" style="margin:0 auto; width: 30%;">
                <label for="name">姓名：</label>
                <input class="form-control" type="text" inputmode="text" name="name" required>
            </div>
            <div class="form-group" style="margin:0 auto; width: 30%;">
                <label for="mail">电子邮件：</label>
                <input class="form-control" type="text" inputmode="email" placeholder="account@example.com" name="mail">
            </div>
            
            <br>
            <table border="4" cellpadding="0" cellspacing="0" style="margin:0 auto; width: 90%;" >
                <tr>
                    <td><h6>id</h6></td>
                    <td><h6>源wav</h6></td>
                    <td><h6>参考wav</h6></td>
                    <td><h6>转换结果</h6></td>
                    <td><h6>转换结果的自然度评分</h6></td>
                    <td><h6>转换结果与参考wav的相似度评分</h6></td>
                </tr>
                <!-- 先把5和10位置摆好，再放置其他的-->
    
                <!-- 0 -->
                <tr> 
                    <!--autoplay="preload"  -->
                    <td><h6>0</h6></td>
                    <td>
                        <audio controls="controls"  height="50" width="50">
                            <source src="resources/UAS_result/ori_wav/M16_B3_UW43_M3.wav" type="audio/wav" />
                        </audio>
                    </td>
    
                    <td>
                        <audio controls="controls"  height="50" width="50">
                            <source src="resources/UAS_result/tts/designate.wav" type="audio/wav" />
                        </audio>
                    </td>
                    
                    <td>
                        <audio controls="controls"  height="50" width="50">
                            <source src="resources/UAS_result/result/0.wav" type="audio/wav" />
                        </audio>
                    </td>
    
                    <td>
                            <!-- idxn表示第x个音频的自然度打分 -->
                            <input type="radio" name="id0n" value="5">5
                            <input type="radio" name="id0n" value="4">4
                            <input type="radio" name="id0n" value="3">3
                            <input type="radio" name="id0n" value="2">2
                            <input type="radio" name="id0n" value="1">1
                    </td>
                    <td>
                            <!-- idxs表示第x个音频的相似度打分打分 -->
                            <input type="radio" name="id0s" value="5">5
                            <input type="radio" name="id0s"value="4">4
                            <input type="radio" name="id0s"value="3">3
                            <input type="radio" name="id0s"value="2">2
                            <input type="radio" name="id0s"value="1">1
                    </td>
                </tr>
    
                <!-- 1 -->
                <tr>
                    <td><h6value="1">1</h6value=></td>
                    <td>
                        <audio controls="controls"  height="50" width="50">
                            <source src="resources/UAS_result/ori_wav/M11_B2_CW79_M3.wav" type="audio/wav" />
                        </audio>
                    </td>
    
                    <td>
                        <audio controls="controls"  height="50" width="50">
                            <source src="resources/UAS_result/tts/my.wav" type="audio/wav" />
                        </audio>
                    </td>
                    
                    <td>
                        <audio controls="controls"  height="50" width="50">
                            <source src="resources/UAS_result/result/1.wav" type="audio/wav" />
                        </audio>
                    </td>
    
                    <td>
                        <!-- idxn表示第x个音频的自然度打分 -->
                        <input type="radio" name="id1n" value="5">5
                        <input type="radio" name="id1n"value="4">4
                        <input type="radio" name="id1n"value="3">3
                        <input type="radio" name="id1n"value="2">2
                        <input type="radio" name="id1n"value="1">1
                    </td>
                    <td>
                        <!-- idxs表示第x个音频的相似度打分打分 -->
                        <input type="radio" name="id1s" value="5">5
                        <input type="radio" name="id1s"value="4">4
                        <input type="radio" name="id1s"value="3">3
                        <input type="radio" name="id1s"value="2">2
                        <input type="radio" name="id1s"value="1">1
                    </td>
                </tr>
    
                <!-- 2 -->
                <tr>
                    <td><h6value="2">2</h6value=></td>
                    <td>
                        <audio controls="controls"  height="50" width="50">
                            <source src="resources/UAS_result/ori_wav/F04_B2_UW83_M7.wav" type="audio/wav" />
                        </audio>
                    </td>
    
                    <td>
                        <audio controls="controls"  height="50" width="50">
                            <source src="resources/UAS_result/tts/plane.wav" type="audio/wav" />
                        </audio>
                    </td>
                    
                    <td>
                        <audio controls="controls"  height="50" width="50">
                            <source src="resources/UAS_result/result/2.wav" type="audio/wav" />
                        </audio>
                    </td>
    
                    <td>
                        <!-- idxn表示第x个音频的自然度打分 -->
                        <input type="radio" name="id2n" value="5">5
                        <input type="radio" name="id2n"value="4">4
                        <input type="radio" name="id2n"value="3">3
                        <input type="radio" name="id2n"value="2">2
                        <input type="radio" name="id2n"value="1">1
                    </td>
                    <td>
                        <!-- idxs表示第x个音频的相似度打分打分 -->
                        <input type="radio" name="id2s"value="5">5
                        <input type="radio" name="id2s"value="4">4
                        <input type="radio" name="id2s"value="3">3
                        <input type="radio" name="id2s"value="2">2
                        <input type="radio" name="id2s"value="1">1
                    </td>
                </tr>
    
                <!-- 3 -->
                <tr>
                    <td><h6value="3">3</h6value=></td>
                    <td>
                        <audio controls="controls"  height="50" width="50">
                            <source src="resources/UAS_result/ori_wav/M10_B3_UW80_M8.wav" type="audio/wav" />
                        </audio>
                    </td>
    
                    <td>
                        <audio controls="controls"  height="50" width="50">
                            <source src="resources/UAS_result/tts/praiseworthy.wav" type="audio/wav" />
                        </audio>
                    </td>
                    
                    <td>
                        <audio controls="controls"  height="50" width="50">
                            <source src="resources/UAS_result/result/3.wav" type="audio/wav" />
                        </audio>
                    </td>
    
                    <td>
                        <!-- idxn表示第x个音频的自然度打分 -->
                        <input type="radio" name="id3n" value="5">5
                        <input type="radio" name="id3n"value="4">4
                        <input type="radio" name="id3n"value="3">3
                        <input type="radio" name="id3n"value="2">2
                        <input type="radio" name="id3n"value="1">1
                    </td>
                    <td>
                        <!-- idxs表示第x个音频的相似度打分打分 -->
                        <input type="radio" name="id3s" value="5">5
                        <input type="radio" name="id3s"value="4">4
                        <input type="radio" name="id3s"value="3">3
                        <input type="radio" name="id3s"value="2">2
                        <input type="radio" name="id3s"value="1">1
                    </td>
                </tr>
    
                <!-- 4 -->
                <tr>
                    <td><h6value="4">4</h6value=></td>
                    <td>
                        <audio controls="controls"  height="50" width="50">
                            <source src="resources/UAS_result/ori_wav/F03_B2_CW55_M5.wav" type="audio/wav" />
                        </audio>
                    </td>
    
                    <td>
                        <audio controls="controls"  height="50" width="50">
                            <source src="resources/UAS_result/tts/many.wav" type="audio/wav" />
                        </audio>
                    </td>
                    
                    <td>
                        <audio controls="controls"  height="50" width="50">
                            <source src="resources/UAS_result/tts/many.wav" type="audio/wav" />
                        </audio>
                    </td>
    
                    <td>
                        <!-- idxn表示第x个音频的自然度打分 -->
                        <input type="radio" name="id4n" value="5">5
                        <input type="radio" name="id4n"value="4">4
                        <input type="radio" name="id4n"value="3">3
                        <input type="radio" name="id4n"value="2">2
                        <input type="radio" name="id4n"value="1">1
                    </td>
                    <td>
                        <!-- idxs表示第x个音频的相似度打分打分 -->
                        <input type="radio" name="id4s" value="5">5
                        <input type="radio" name="id4s"value="4">4
                        <input type="radio" name="id4s"value="3">3
                        <input type="radio" name="id4s"value="2">2
                        <input type="radio" name="id4s"value="1">1
                    </td>
                </tr>

                
            </table>
        </center>
        <center>
            <input class="btn btn-info btn-lg" type="submit" value="SUBMIT" id="submitBtn">
            <input type="text" name="formid" value="uas" hidden>
            <input type="text" name="thank" value="Thank you again for participating in this experiment!" hidden>
        </center>
    </form>
        <center>
        <!-- <form method="post", action="/">
            <input style="height: 50px;width: 100px;" type="submit" value="返回主页" >
        </form> -->
        <a href="index.html">返回主页</a>
        <!-- 这里应该返回一个值记录该听众完成了uas的评估，记录为一个全局变量 -->
    </center>
    <script type="text/javascript">
        function preventRepeatedSubmission() {
            document.getElementById('submitBtn').disabled = true;
            setTimeout("submitBtn.disabled=false;", 5000);
            return true;
        };
    </script>
    <script> //产生n个不重复的指定范围内的随机数
        //函数1 求指定范围内的一个随机数
        function selectFrom(min,max)
        {
            var sum = max-min+1;
            return Math.floor(Math.random()*sum+min);
        }
        //函数2 求指定范围内n个不重复的随机数
        function myNum(n,min,max)
        {
            var a = [];
            for(i=0;i<n;i++)
            {
                a[i]=selectFrom(min,max);
                for(z=0;z<i;z++)
                {
                    if(a[i]==a[z])
                    {
                        i--;
                        break;
                    }
                }     
            }
            return a;
        }
        var result = myNum(5,0,11); //测试发现做到了每次尝试的都不一样
        console.log(result.toString());
        for(i=0;i<result.length;i++)
        {
            //setTimeout(() => {
            document.getElementsByTagName("audio")[3*i+0].setAttribute("src","resources/UAS_result/"+result[i].toString()+"/ori.wav")
            //}, 500)
            //console.log("./../resources/SC_result/"+result[i].toString()+"/ori.wav")
            document.getElementsByTagName("audio")[3*i+1].setAttribute("src","resources/UAS_result/"+result[i].toString()+"/tts.wav")
            document.getElementsByTagName("audio")[3*i+2].setAttribute("src","resources/UAS_result/"+result[i].toString()+"/re.wav")
            console.log(i.toString())
        }
        console.log("success")
    </script>
</body>

</html>
