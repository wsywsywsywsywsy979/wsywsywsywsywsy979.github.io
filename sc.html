<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>SC:英文（无构音障碍）短句子归一化</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.1/css/bootstrap.min.css"
        integrity="sha384-VCmXjywReHh4PwowAiWNagnWcLhlEJLA5buUprzK8rxFgeH0kww/aWY76TfkUoSX" crossorigin="anonymous">
    <link rel="stylesheet" href="./style.css">
    <script src="resources/jquery.min.js"></script>
    <script src="resources/script.js"></script>
    
    <center> 
        <h6 style="font-family: 新宋体;">
            <br>
            <br>
            请在安静环境下佩戴耳机用谷歌浏览器完成以下问题。
            <!-- ，问卷由程序随机生成，欢迎您在提交成功后通过刷新页面多次作答。 -->
            <!-- 文本放置有输入测试，您可以选择发音为：
            [
                "Yes", "No", "Up", "Down", "Left","Right", "On", "Off", "Stop", "Go", 
                "Zero", "One", "Two", "Three", "Four","Five", "Six", "Seven", "Eight", "Nine"
                "Bed", "Bird", "Cat", "Dog", "Happy", "House", "Marvin", "Sheila","Tree", and "Wow".]
            的音频测试模型转换效果。 -->
            
            <br>
            评估分为两部分：语音自然度评估和语音相似度评估。
            <br>
            语音自然度评估方式：请依次播放“转换结果”栏的音频，如果该音频与机器音越接近则得分越低，与人声越接近则得分越高。
            <br>
            语音相似度评估方式：请将每一行的“参考wav”与对应行的“转换结果”进行对比，如果“转换结果”与“参考wav”越像则得分越高，反之得分越低。
            <br>
            评分标准如下表所示：
            <!-- <table border="1" cellpadding="0" cellspacing="0" >
                <tr>
                    <td><h6 style="font-family: 新宋体;">分值</h6></td>
                    <td><h6 style="font-family: 新宋体;">自然度评测标准</h6></td>
                    <td><h6 style="font-family: 新宋体;">相似度标准</h6></td>
                </tr>
                <tr>
                    <td><h6 style="font-family: 新宋体;"value="5">5</h6></td>
                    <td><h6 style="font-family: 新宋体;">音质清晰；发音流畅准确；韵律自然；音色较好</h6></td>
                    <td><h6 style="font-family: 新宋体;">非常相似</h6></td>
                </tr>		
                <tr>
                    <td><h6 style="font-family: 新宋体;"value="4">4</h6></td>
                    <td><h6 style="font-family: 新宋体;">偶尔几个音节/单词模糊；发音比较流畅，错误较少；无严重韵律错误；音色良好 </h6></td>
                    <td><h6 style="font-family: 新宋体;">比较相似</h6></td>
                </tr>		
                <tr>
                    <td><h6 style="font-family: 新宋体;"value="3">3</h6></td>
                    <td><h6 style="font-family: 新宋体;">一些音节模糊；发音不太流畅，有无明显错误；有一些不太正常的韵律；音色一般 </h6></td>
                    <td><h6 style="font-family: 新宋体;">一般相似</h6></td>
                </tr>		
                <tr>
                    <td><h6 style="font-family: 新宋体;"value="2">2</h6></td>
                    <td><h6 style="font-family: 新宋体;">有一些词不太清晰；发音不流畅，难以理解；基本没有韵律；音色差</h6></td>
                    <td><h6 style="font-family: 新宋体;">有些相似</h6></td>
                </tr>		
                <tr>
                    <td><h6 style="font-family: 新宋体;"value="1">1</h6></td>
                    <td><h6 style="font-family: 新宋体;">音质很不清晰；发音很不流畅，无法理解；无韵律起伏；明显机器音</h6></td>
                    <td><h6 style="font-family: 新宋体;">完全不相似</h6></td>
                </tr>        
            </table> -->
            <p style="text-align: center">
                <img src="resources/static/mos.png" style="margin:0 auto; width: 50%;">
            </p>
        </h6>
    </center>
</head>

<body>
    <form id="theForm" action="https://script.google.com/macros/s/AKfycbxwc4EP7Rw0SSvCKjYe_InMY-P4BLkqjh5VDz7uJJ-anKohPzgAL5X1bpWiR7rRRsSl/dev" method="GET" onsubmit="return preventRepeatedSubmission();">
    <center>
        <div class="form-group" style="margin:0 auto; width: 30%;">
                <label for="name">姓名：</label>
                <input class="form-control" type="text" inputmode="text" name="name" required>
<!--                <small class="form-text text-muted">必填*</small>-->
        </div>
        <div class="form-group" style="margin:0 auto; width: 30%;">
            <label for="mail">电子邮件：</label>
            <input class="form-control" type="text" inputmode="email" placeholder="account@example.com" name="mail">
<!--                <small class="form-text text-muted">如果中獎，我們將以電子郵件通知您</small>-->
        </div>
        <br>

        <table border="4" cellpadding="0" cellspacing="0" style="margin:0 auto; width: 90%;">
            <tr>
                <td><h6>id</h6></td>
                <td><h6>源wav</h6></td>
                <td><h6>参考wav</h6></td>
                <td><h6>转换结果</h6></td>
                <td><h6>转换结果的自然度评分</h6></td>
                <td><h6>转换结果与参考wav的相似度评分</h6></td>
            </tr>
            <!-- 先把5和10位置摆好，再放置其他的-->

            <!-- 0 -->
            <tr> 
                <!--autoplay="preload"  -->
                <td><h6>0</h6></td>
                <td>
                    <audio controls="controls"  height="50" width="50">
                        <source src="resources/SC_result/ori_wav/left279.wav" type="audio/wav" />
                    </audio>
                </td>

                <td>
                    <audio controls="controls"  height="50" width="50">
                        <source src="resources/SC_result/tts/left.wav" type="audio/wav" />
                    </audio>
                </td>
                
                <td>
                    <audio controls="controls"  height="50" width="50">
                        <source src="resources/SC_result/result/0.wav" type="audio/wav" />
                    </audio>
                </td>

                <td>
                        <!-- idxn表示第x个音频的自然度打分 -->
                        <input type="radio" name="id0n" value="5">5
                        <input type="radio" name="id0n" value="4">4
                        <input type="radio" name="id0n" value="3">3
                        <input type="radio" name="id0n" value="2">2
                        <input type="radio" name="id0n" value="1">1
                </td>
                <td>
                        <!-- idxs表示第x个音频的相似度打分打分 -->
                        <input type="radio" name="id0s" value="5">5
                        <input type="radio" name="id0s"value="4">4
                        <input type="radio" name="id0s"value="3">3
                        <input type="radio" name="id0s"value="2">2
                        <input type="radio" name="id0s"value="1">1
                </td>
            </tr>

            <!-- 1 -->
            <tr>
                <td><h6value="1">1</h6value=></td>
                <td>
                    <audio controls="controls"  height="50" width="50">
                        <source src="resources/SC_result/ori_wav/house206.wav" type="audio/wav" />
                    </audio>
                </td>

                <td>
                    <audio controls="controls"  height="50" width="50">
                        <source src="resources/SC_result/tts/house.wav" type="audio/wav" />
                    </audio>
                </td>
                
                <td>
                    <audio controls="controls"  height="50" width="50">
                        <source src="resources/SC_result/result/1.wav" type="audio/wav" />
                    </audio>
                </td>

                <td>
                    <!-- idxn表示第x个音频的自然度打分 -->
                    <input type="radio" name="id1n" value="5">5
                    <input type="radio" name="id1n"value="4">4
                    <input type="radio" name="id1n"value="3">3
                    <input type="radio" name="id1n"value="2">2
                    <input type="radio" name="id1n"value="1">1
                </td>
                <td>
                    <!-- idxs表示第x个音频的相似度打分打分 -->
                    <input type="radio" name="id1s" value="5">5
                    <input type="radio" name="id1s"value="4">4
                    <input type="radio" name="id1s"value="3">3
                    <input type="radio" name="id1s"value="2">2
                    <input type="radio" name="id1s"value="1">1
                </td>
            </tr>

            <!-- 2 -->
            <tr>
                <td><h6value="2">2</h6value=></td>
                <td>
                    <audio controls="controls"  height="50" width="50">
                        <source src="resources/SC_result/ori_wav/down386.wav" type="audio/wav" />
                    </audio>
                </td>

                <td>
                    <audio controls="controls"  height="50" width="50">
                        <source src="resources/SC_result/tts/down.wav" type="audio/wav" />
                    </audio>
                </td>
                
                <td>
                    <audio controls="controls"  height="50" width="50">
                        <source src="resources/SC_result/result/2.wav" type="audio/wav" />
                    </audio>
                </td>

                <td>
                    <!-- idxn表示第x个音频的自然度打分 -->
                    <input type="radio" name="id2n" value="5">5
                    <input type="radio" name="id2n"value="4">4
                    <input type="radio" name="id2n"value="3">3
                    <input type="radio" name="id2n"value="2">2
                    <input type="radio" name="id2n"value="1">1
                </td>
                <td>
                    <!-- idxs表示第x个音频的相似度打分打分 -->
                    <input type="radio" name="id2s"value="5">5
                    <input type="radio" name="id2s"value="4">4
                    <input type="radio" name="id2s"value="3">3
                    <input type="radio" name="id2s"value="2">2
                    <input type="radio" name="id2s"value="1">1
                </td>
            </tr>

            <!-- 3 -->
            <tr>
                <td><h6value="3">3</h6value=></td>
                <td>
                    <audio controls="controls"  height="50" width="50">
                        <source src="resources/SC_result/ori_wav/stop441.wav" type="audio/wav" />
                    </audio>
                </td>

                <td>
                    <audio controls="controls"  height="50" width="50">
                        <source src="resources/SC_result/tts/stop.wav" type="audio/wav" />
                    </audio>
                </td>
                
                <td>
                    <audio controls="controls"  height="50" width="50">
                        <source src="resources/SC_result/result/3.wav" type="audio/wav" />
                    </audio>
                </td>

                <td>
                    <!-- idxn表示第x个音频的自然度打分 -->
                    <input type="radio" name="id3n" value="5">5
                    <input type="radio" name="id3n"value="4">4
                    <input type="radio" name="id3n"value="3">3
                    <input type="radio" name="id3n"value="2">2
                    <input type="radio" name="id3n"value="1">1
                </td>
                <td>
                    <!-- idxs表示第x个音频的相似度打分打分 -->
                    <input type="radio" name="id3s" value="5">5
                    <input type="radio" name="id3s"value="4">4
                    <input type="radio" name="id3s"value="3">3
                    <input type="radio" name="id3s"value="2">2
                    <input type="radio" name="id3s"value="1">1
                </td>
            </tr>

            <!-- 4 -->
            <tr>
                <td><h6value="4">4</h6value=></td>
                <td>
                    <audio controls="controls"  height="50" width="50">
                        <source src="resources/SC_result/ori_wav/seven1155.wav" type="audio/wav" />
                    </audio>
                </td>

                <td>
                    <audio controls="controls"  height="50" width="50">
                        <source src="resources/SC_result/tts/seven.wav" type="audio/wav" />
                    </audio>
                </td>
                
                <td>
                    <audio controls="controls"  height="50" width="50">
                        <source src="resources/SC_result/tts/seven.wav" type="audio/wav" />
                    </audio>
                </td>

                <td>
                    <!-- idxn表示第x个音频的自然度打分 -->
                    <input type="radio" name="id4n" value="5">5
                    <input type="radio" name="id4n"value="4">4
                    <input type="radio" name="id4n"value="3">3
                    <input type="radio" name="id4n"value="2">2
                    <input type="radio" name="id4n"value="1">1
                </td>
                <td>
                    <!-- idxs表示第x个音频的相似度打分打分 -->
                    <input type="radio" name="id4s" value="5">5
                    <input type="radio" name="id4s"value="4">4
                    <input type="radio" name="id4s"value="3">3
                    <input type="radio" name="id4s"value="2">2
                    <input type="radio" name="id4s"value="1">1
                </td>
            </tr>
            
        </table>
    </center>
    <center>
        <!-- <form method="post", action="/"> -->
            <!-- 待补充功能，这个每个模型需要区分开，记录到不同的文本中，就每个提交都创建一个txt记录，最后总的统计即可 -->
            <!-- 需要可以检测是否10个都已评分完毕 -->
            <!-- <input style="height: 50px;width: 100px;" type="submit" value="提交评分" > -->
        <!-- </form>  -->
        <!-- <button onclick="my_submit()" >提交评分</button> -->
        <!-- 注意要写括号 -->
        <input class="btn btn-info btn-lg" type="submit" value="SUBMIT" id="submitBtn">
        <br>
        <label>展示音频由程序随机产生，刷新页面可更换音频多次评估并提交结果</label>
        <input type="text" name="formid" value="sc" hidden>
        <input type="text" name="thank" value="Thank you again for participating in this experiment!" hidden>
    </center>
        
    </form>

    <center>
        <!-- <form method="post", action="/">
            <input style="height: 50px;width: 100px;" type="submit" value="返回主页" >
        </form> -->
         <!-- 这里应该返回一个值记录该听众完成了sc的评估，记录为一个全局变量 -->
         <a href="index.html">返回主页</a>
    </center>
    <script type="text/javascript">
        function preventRepeatedSubmission() {
            document.getElementById('submitBtn').disabled = true;
            setTimeout("submitBtn.disabled=false;", 5000);
            return true;
        };
    </script>
    <script> //产生n个不重复的指定范围内的随机数
        //函数1 求指定范围内的一个随机数
        function selectFrom(min,max)
        {
            var sum = max-min+1;
            return Math.floor(Math.random()*sum+min);
        }
        //函数2 求指定范围内n个不重复的随机数
        function myNum(n,min,max)
        {
            var a = [];
            for(i=0;i<n;i++)
            {
                a[i]=selectFrom(min,max);
                for(z=0;z<i;z++)
                {
                    if(a[i]==a[z])
                    {
                        i--;
                        break;
                    }
                }     
            }
            return a;
        }
        var result = myNum(5,0,10); //测试发现做到了每次尝试的都不一样
        console.log(result.toString());
        for(i=0;i<result.length;i++)
        {
            //setTimeout(() => {
            document.getElementsByTagName("audio")[3*i+0].setAttribute("src","resources/SC_result/"+result[i].toString()+"/ori.wav")
            //}, 500)
            //console.log("./../resources/SC_result/"+result[i].toString()+"/ori.wav")
            document.getElementsByTagName("audio")[3*i+1].setAttribute("src","resources/SC_result/"+result[i].toString()+"/tts.wav")
            document.getElementsByTagName("audio")[3*i+2].setAttribute("src","resources/SC_result/"+result[i].toString()+"/re.wav")
            console.log(i.toString())
        }
        console.log("success")
    </script>
</body>

</html>
